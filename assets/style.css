/* ---------- Layout ---------- */
:root{
  --bg:#ffffff;
  --ui:#f6f7f9;
  --ui-border:#e3e6ea;
  --ui-strong:#c9ced6;
  --accent:#3b82f6;          /* selection + fill handle */
  --accent-weak:#eaf1ff;
  --text:#111;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0; background:var(--bg); color:var(--text);
  font:14px/1.3 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;
  display:flex; flex-direction:column;
}

/* ---------- Header / Toolbar ---------- */
header{ background:var(--ui); border-bottom:1px solid var(--ui-border); }
header h1{ margin:0; padding:10px 12px; font-size:16px; font-weight:700; }
.toolbar{
  display:flex; flex-wrap:wrap; gap:8px; align-items:center;
  padding:8px 12px 12px 12px;
}
.toolbar select,
.toolbar input[type="color"],
.toolbar button{
  border:1px solid var(--ui-strong); background:#fff; color:var(--text);
  border-radius:8px; padding:6px 10px; height:34px; cursor:pointer;
}
.toolbar label{ display:flex; align-items:center; gap:6px; }
.toolbar button:hover{ background:#fff; box-shadow:0 1px 0 rgba(0,0,0,.04); }
.toolbar button:active{ transform:translateY(1px); }
.toolbar button#boldBtn{ font-weight:700; }
.toolbar button#italicBtn{ font-style:italic; }
.toolbar button#underlineBtn{ text-decoration:underline; }

/* Align buttons glyphs */
#alignLeftBtn, #alignCenterBtn, #alignRightBtn{ width:34px; }

/* ---------- Status bar ---------- */
.status{
  display:flex; gap:18px; padding:8px 12px; font-size:13px;
  border-top:1px solid var(--ui-border); background:var(--ui);
}

/* ---------- Grid container ---------- */
main#gridContainer{
  flex:1; overflow:auto; background:#fff;
  border-top:1px solid var(--ui-border);
  border-bottom:1px solid var(--ui-border);
}

/* ---------- Table / Grid ---------- */
table.grid{
  border-collapse:separate; border-spacing:0;
  width:max-content; min-width:100%;
  table-layout:fixed;
}
.grid thead th{
  position:sticky; top:0; z-index:3;
  background:#fbfcfe; border-bottom:1px solid var(--ui-border);
  font-weight:600; height:28px; padding:0 8px; text-align:left;
}
.grid tbody th.row-hdr{
  position:sticky; left:0; z-index:2;
  background:#fbfcfe; border-right:1px solid var(--ui-border);
  font-weight:600; width:48px; text-align:right; padding:0 8px;
}

.grid th, .grid td{
  border-right:1px solid var(--ui-border);
  border-bottom:1px solid var(--ui-border);
}
.grid th:first-child{ border-left:1px solid var(--ui-border); }
.grid tr:first-child th{ border-top:1px solid var(--ui-border); }
.grid td.cell{
  position:relative; width:120px; height:28px; padding:0; background:#fff;
}
.grid td.cell input{
  width:100%; height:100%; border:0; outline:0; background:transparent;
  padding:6px 8px; font:inherit; color:inherit; overflow:hidden; text-overflow:ellipsis;
}

/* Active cell blue dot (ONE cell only; JS keeps it unique) */
.grid td.cell.active::after{
  content:''; position:absolute; top:4px; right:4px;
  width:8px; height:8px; border-radius:50%; background:var(--accent);
}

/* Listening pulse (optional) */
.grid td.cell.listening::after{
  animation:pulse 1s infinite;
}
@keyframes pulse{
  0%{ transform:scale(0.75); opacity:.35; }
  50%{ transform:scale(1); opacity:1; }
  100%{ transform:scale(0.75); opacity:.35; }
}

/* ---------- Column resizer ---------- */
.grid th[data-c]{ position:relative; }
.col-resizer{
  position:absolute; right:-3px; top:0; width:6px; height:100%;
  cursor:col-resize; z-index:5;
}
.col-resizer:hover{ background:rgba(0,0,0,.04); }

/* ---------- Selection rectangle & fill handle ---------- */
.sel-rect{
  outline:2px solid var(--accent); outline-offset:-2px;
}
.fill-handle{
  position:absolute; width:8px; height:8px; background:var(--accent);
  bottom:-4px; right:-4px; border-radius:2px; cursor:crosshair; z-index:6;
}

/* Highlight active row/column for tracking */
.highlight-col td:nth-child(var(--col-idx)){ background: var(--accent-weak); }
.highlight-row tr:nth-child(var(--row-idx)) td{ background: var(--accent-weak); }

/* ---------- Merged cells ---------- */
/* Master cell will get rowspan/colspan from JS; hidden cells use display:none */
.grid td.cell[hidden]{ display:none !important; }

/* ---------- Wrapping & Alignment classes (applied inline via JS) ---------- */
.cell.align-left input{ text-align:left; }
.cell.align-center input{ text-align:center; }
.cell.align-right input{ text-align:right; }
.cell.wrap input{ white-space:normal; }
.cell.nowrap input{ white-space:nowrap; }

/* ---------- Context menu ---------- */
#ctxMenu{
  display:none; position:fixed; z-index:10000; background:#fff;
  border:1px solid var(--ui-border); border-radius:10px;
  box-shadow:0 12px 32px rgba(0,0,0,.12); min-width:180px; overflow:hidden;
}
#ctxMenu .ctx-item{
  display:block; width:100%; text-align:left; padding:10px 12px;
  background:#fff; border:0; cursor:pointer; font-size:14px;
}
#ctxMenu .ctx-item:hover{ background:#f5f7ff; }
#ctxMenu .ctx-item.danger{ color:#b00020; }
#ctxMenu .ctx-sep{ margin:0; border:0; border-top:1px solid #eee; }

/* ---------- Utility ---------- */
.hidden{ display:none !important; }

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Voice Sheet App</title>
  <link rel="stylesheet" href="assets/style.css"/>

  <!-- Context-menu shim so styles apply to #context-menu as well -->
  <style>
    /* Context menu */
    #context-menu{
      display:none; position:fixed; z-index:10000; background:#fff;
      border:1px solid #e3e6ea; border-radius:10px;
      box-shadow:0 12px 32px rgba(0,0,0,.12); min-width:180px; overflow:hidden;
    }
    #context-menu .ctx-item{
      display:block; width:100%; text-align:left; padding:10px 12px;
      background:#fff; border:0; cursor:pointer; font-size:14px;
    }
    #context-menu .ctx-item:hover{ background:#f5f7ff; }
    #context-menu .ctx-item.danger{ color:#b00020; }
    #context-menu .ctx-sep{ margin:0; border:0; border-top:1px solid #eee; }

    /* Export/Import dropdowns */
    .dropdown{ position:relative; display:inline-block; }
    .dropbtn{
      background:#4CAF50; color:#fff; padding:6px 10px; font-size:14px;
      border:none; cursor:pointer; border-radius:8px;
    }
    .dropdown-content{
      display:none; position:absolute; background:#fff; min-width:180px;
      box-shadow:0 8px 16px rgba(0,0,0,.2); z-index:1000; border-radius:8px; overflow:hidden;
    }
    .dropdown-content a{
      display:block; padding:8px 12px; text-decoration:none; color:#111;
    }
    .dropdown-content a:hover{ background:#f1f1f1; }
    .dropdown:hover .dropdown-content{ display:block; }
    .dropdown:hover .dropbtn{ background:#3da845; }
  </style>
</head>
<body>
  <header>
    <h1>Voice Sheet App</h1>

    <div class="toolbar">
      <!-- Mic + navigation -->
      <button id="micBtn" title="Start/stop microphone">Mic ▶</button>
      <label>Direction:
        <select id="direction">
          <option value="right" selected>Right →</option>
          <option value="left">← Left</option>
          <option value="down">Down ↓</option>
          <option value="up">↑ Up</option>
        </select>
      </label>
      <label><input type="checkbox" id="autoAdvance" checked> Auto-advance</label>
      <label>Silence (ms): <input id="silenceMs" type="number" value="1000" min="200" step="100" style="width:6ch"></label>

      <!-- Row ops -->
      <button id="btn-insert-row-above">+ Row ↑</button>
      <button id="btn-insert-row-below">+ Row ↓</button>
      <button id="btn-delete-row">Delete Row</button>
      <button id="btn-move-row-up">Move Row ↑</button>
      <button id="btn-move-row-down">Move Row ↓</button>

      <!-- Col ops -->
      <button id="btn-insert-col-left">+ Col ←</button>
      <button id="btn-insert-col-right">+ Col →</button>
      <button id="btn-delete-col">Delete Col</button>
      <button id="btn-move-col-left">Move Col ←</button>
      <button id="btn-move-col-right">Move Col →</button>

      <!-- Merge -->
      <button id="btn-merge">Merge</button>
      <button id="btn-unmerge">Unmerge</button>

      <!-- Column width -->
      <button id="btn-autofit" title="Auto-fit current column">Auto-fit</button>

      <!-- File -->
      <div class="dropdown">
        <button class="dropbtn">Export ▼</button>
        <div class="dropdown-content">
          <a href="#" id="export-xlsx">Excel (.xlsx)</a>
          <a href="#" id="export-csv">CSV (.csv)</a>
          <a href="#" id="export-tsv">TSV (.tsv)</a>
        </div>
      </div>

      <div class="dropdown">
        <button class="dropbtn">Import ▼</button>
        <div class="dropdown-content">
          <a href="#" id="import-xlsx">Excel (.xlsx)</a>
          <a href="#" id="import-csv">CSV (.csv)</a>
          <a href="#" id="import-tsv">TSV (.tsv)</a>
        </div>
      </div>

      <!-- Grid lifecycle -->
      <button id="btn-new-grid" title="Create a new blank grid">New Grid</button>
      <button id="btn-clear-grid" title="Clear all cells">Clear</button>
    </div>
  </header>

  <!-- Grid host (table grid is rendered here by grid.js) -->
  <main id="grid-container"></main>

  <!-- Status bar -->
  <section class="status">
    <div>Active cell: <span id="status-cell">A1</span></div>
  </section>

  <!-- Right-click context menu -->
  <div id="context-menu">
    <button id="ctx-copy"   class="ctx-item">Copy</button>
    <button id="ctx-cut"    class="ctx-item">Cut</button>
    <button id="ctx-paste"  class="ctx-item">Paste</button>
    <hr class="ctx-sep">
    <button id="ctx-delete" class="ctx-item danger">Delete</button>
  </div>

  <!-- SheetJS for Excel import/export -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <!-- App logic (uses table-based grid.js) -->
  <script type="module" src="src/main.js"></script>
</body>
</html>
